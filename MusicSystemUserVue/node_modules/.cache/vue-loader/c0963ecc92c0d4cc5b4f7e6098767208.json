{"remainingRequest":"F:\\外包项目重置\\音乐管理系统\\影院管理系统\\MusicSystem\\MusicSystemUserVue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\外包项目重置\\音乐管理系统\\影院管理系统\\MusicSystem\\MusicSystemUserVue\\src\\pages\\SongListAlbum.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\外包项目重置\\音乐管理系统\\影院管理系统\\MusicSystem\\MusicSystemUserVue\\src\\pages\\SongListAlbum.vue","mtime":1696063594000},{"path":"F:\\外包项目重置\\音乐管理系统\\影院管理系统\\MusicSystem\\MusicSystemUserVue\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1696214897000},{"path":"F:\\外包项目重置\\音乐管理系统\\影院管理系统\\MusicSystem\\MusicSystemUserVue\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":1696214897000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQge21peGlufSBmcm9tICcuLi9taXhpbnMnOw0KaW1wb3J0IHttYXBHZXR0ZXJzfSBmcm9tICd2dWV4JzsNCmltcG9ydCB7bGlzdFNvbmdEZXRhaWwsc29uZ09mU29uZ0lkLHNldFJhbmssZ2V0UmFua09mU29uZ0xpc3RJZH0gZnJvbSAnLi4vYXBpL2luZGV4JzsNCmltcG9ydCBBbGJ1bUNvbnRlbnQgZnJvbSAiLi4vY29tcG9uZW50cy9BbGJ1bUNvbnRlbnQiOw0KaW1wb3J0IENvbW1lbnQgZnJvbSAiLi4vY29tcG9uZW50cy9Db21tZW50IjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICAgIG5hbWU6ICdzb25nLWxpc3QtYWxidW0nLA0KICAgIG1peGluczogW21peGluXSwNCiAgICBjb21wb25lbnRzOnsNCiAgICAgICAgQWxidW1Db250ZW50LA0KICAgICAgICBDb21tZW50DQogICAgfSwNCiAgICBkYXRhKCl7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBzb25nTGlzdHM6IFtdLCAgICAgIC8v5b2T5YmN6aG16Z2i6ZyA6KaB5bGV56S655qE5q2M5puy5YiX6KGoDQogICAgICAgICAgICBzb25nTGlzdElkOiAnJywgICAgLy/liY3pnaLkvKDmnaXnmoTmrYzljZVpZA0KICAgICAgICAgICAgYXZlcmFnZTogMCwgICAgICAgICAvL+W5s+Wdh+WIhg0KICAgICAgICAgICAgcmFuazogIDAgICAgICAgICAgICAvL+aPkOS6pOivhOS7t+eahOWIhuaVsA0KICAgICAgICB9DQogICAgfSwNCiAgICBjb21wdXRlZDp7DQogICAgICAgIC4uLm1hcEdldHRlcnMoWw0KICAgICAgICAgICAgJ2xpc3RPZlNvbmdzJywgICAgICAvL+W9k+WJjeaSreaUvuWIl+ihqA0KICAgICAgICAgICAgJ3RlbXBMaXN0JywgICAgICAgICAvL+W9k+WJjeatjOWNleWvueixoQ0KICAgICAgICAgICAgJ2xvZ2luSW4nLCAgICAgICAgICAvL+eUqOaIt+aYr+WQpuW3sueZu+W9lQ0KICAgICAgICAgICAgJ3VzZXJJZCcsICAgICAgICAgICAvL+W9k+WJjeeZu+W9leeUqOaIt2lkDQogICAgICAgIF0pDQogICAgfSwNCiAgICBjcmVhdGVkKCl7DQogICAgICAgIHRoaXMuc29uZ0xpc3RJZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsNCiAgICAgICAgdGhpcy5nZXRTb25nSWQoKTsNCiAgICAgICAgdGhpcy5nZXRSYW5rKHRoaXMuc29uZ0xpc3RJZCk7DQogICAgfSwNCiAgICBtZXRob2RzOnsNCiAgICAgICAgLy/ojrflj5blvZPliY3mrYzljZXnmoTmrYzmm7LliJfooagNCiAgICAgICAgZ2V0U29uZ0lkKCl7DQogICAgICAgICAgICBsaXN0U29uZ0RldGFpbCh0aGlzLnNvbmdMaXN0SWQpDQogICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpdGVtIG9mIHJlcyl7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFNvbmdMaXN0KGl0ZW0uc29uZ0lkKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldExpc3RPZlNvbmdzJyx0aGlzLnNvbmdMaXN0cyk7DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+ew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgfSwNCiAgICAgICAgLy/moLnmja7mrYzmm7JpZOiOt+WPluatjOabsuS/oeaBrw0KICAgICAgICBnZXRTb25nTGlzdChpZCl7DQogICAgICAgICAgICBzb25nT2ZTb25nSWQoaWQpDQogICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zb25nTGlzdHMucHVzaChyZXMpOw0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PnsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgIH0sDQogICAgICAgIC8v6I635Y+W5q2M5Y2V6K+E5YiGDQogICAgICAgIGdldFJhbmsoaWQpew0KICAgICAgICAgICAgZ2V0UmFua09mU29uZ0xpc3RJZChpZCkNCiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmF2ZXJhZ2UgPSByZXMvMjsNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT57DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycikNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICB9LA0KICAgICAgICAvL+aPkOS6pOivhOWIhg0KICAgICAgICBzZXRSYW5rKCl7DQogICAgICAgICAgICBpZih0aGlzLmxvZ2luSW4pew0KICAgICAgICAgICAgICAgIGxldCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7DQogICAgICAgICAgICAgICAgcGFyYW1zLmFwcGVuZCgnc29uZ0xpc3RJZCcsdGhpcy5zb25nTGlzdElkKTsNCiAgICAgICAgICAgICAgICBwYXJhbXMuYXBwZW5kKCdjb25zdW1lcklkJyx0aGlzLnVzZXJJZCk7DQogICAgICAgICAgICAgICAgcGFyYW1zLmFwcGVuZCgnc2NvcmUnLHRoaXMucmFuayAqMik7DQogICAgICAgICAgICAgICAgc2V0UmFuayhwYXJhbXMpDQogICAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihyZXMuY29kZSA9PSAxKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSgn6K+E5YiG5oiQ5YqfJywnc3VjY2VzcycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0UmFuayh0aGlzLnNvbmdMaXN0SWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoJ+ivhOWIhuWksei0pScsJ2Vycm9yJyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT57DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSgn5oKo5bey57uP6K+E5Lu36L+H5ZWmJywnZXJyb3InKTsNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIHRoaXMucmFuayA9IG51bGw7DQogICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KCfor7flhYjnmbvlvZUnLCd3YXJuaW5nJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQo="},{"version":3,"sources":["SongListAlbum.vue"],"names":[],"mappings":";AA4CA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SongListAlbum.vue","sourceRoot":"src/pages","sourcesContent":["<template>\r\n    <div class=\"song-list-album\">\r\n        <div class=\"album-slide\">\r\n            <div class=\"album-img\">\r\n                <img :src=\"attachImageUrl(tempList.pic)\">\r\n            </div>\r\n            <div class=\"album-info\">\r\n                <h2>简介：</h2>\r\n                <span>\r\n                    {{tempList.introduction}}\r\n                </span>\r\n            </div>\r\n        </div>\r\n        <div class=\"album-content\">\r\n            <div class=\"album-title\">\r\n                <p>{{tempList.title}}</p>\r\n            </div>\r\n            <div class=\"album-score\">\r\n                <div>\r\n                    <h3>歌单评分：</h3>\r\n                    <div>\r\n                        <el-rate v-model=\"average\" disabled></el-rate>\r\n                    </div>                    \r\n                </div>\r\n                <span>{{average*2}}</span>\r\n                <div>\r\n                    <h3>评价：</h3>\r\n                    <div @click=\"setRank\">\r\n                        <el-rate v-model=\"rank\" allow-half show-text></el-rate>\r\n                    </div>                    \r\n                </div>\r\n            </div>\r\n            <div class=\"songs-body\">\r\n                <album-content :songList=\"listOfSongs\">\r\n                    <template slot=\"title\">\r\n                <i class=\"iconfont icon-r-list\" style=\"font-size: 26px\"></i>\r\n                <b style=\"font-size: 24px\"> 歌单</b></template>\r\n                </album-content>\r\n                <comment :playId=\"songListId\" :type=\"1\"></comment>\r\n            </div>\r\n        </div>        \r\n    </div>\r\n</template>\r\n<script>\r\nimport {mixin} from '../mixins';\r\nimport {mapGetters} from 'vuex';\r\nimport {listSongDetail,songOfSongId,setRank,getRankOfSongListId} from '../api/index';\r\nimport AlbumContent from \"../components/AlbumContent\";\r\nimport Comment from \"../components/Comment\";\r\n\r\nexport default {\r\n    name: 'song-list-album',\r\n    mixins: [mixin],\r\n    components:{\r\n        AlbumContent,\r\n        Comment\r\n    },\r\n    data(){\r\n        return {\r\n            songLists: [],      //当前页面需要展示的歌曲列表\r\n            songListId: '',    //前面传来的歌单id\r\n            average: 0,         //平均分\r\n            rank:  0            //提交评价的分数\r\n        }\r\n    },\r\n    computed:{\r\n        ...mapGetters([\r\n            'listOfSongs',      //当前播放列表\r\n            'tempList',         //当前歌单对象\r\n            'loginIn',          //用户是否已登录\r\n            'userId',           //当前登录用户id\r\n        ])\r\n    },\r\n    created(){\r\n        this.songListId = this.$route.params.id;\r\n        this.getSongId();\r\n        this.getRank(this.songListId);\r\n    },\r\n    methods:{\r\n        //获取当前歌单的歌曲列表\r\n        getSongId(){\r\n            listSongDetail(this.songListId)\r\n                .then(res => {\r\n                    for(let item of res){\r\n                        this.getSongList(item.songId);\r\n                    }\r\n                    this.$store.commit('setListOfSongs',this.songLists);\r\n                })\r\n                .catch(err =>{\r\n                    console.log(err)\r\n                })\r\n        },\r\n        //根据歌曲id获取歌曲信息\r\n        getSongList(id){\r\n            songOfSongId(id)\r\n                .then(res => {\r\n                    this.songLists.push(res);\r\n                })\r\n                .catch(err =>{\r\n                    console.log(err)\r\n                })\r\n        },\r\n        //获取歌单评分\r\n        getRank(id){\r\n            getRankOfSongListId(id)\r\n                .then(res => {\r\n                    this.average = res/2;\r\n                })\r\n                .catch(err =>{\r\n                    console.log(err)\r\n                })\r\n        },\r\n        //提交评分\r\n        setRank(){\r\n            if(this.loginIn){\r\n                let params = new URLSearchParams();\r\n                params.append('songListId',this.songListId);\r\n                params.append('consumerId',this.userId);\r\n                params.append('score',this.rank *2);\r\n                setRank(params)\r\n                    .then(res => {\r\n                        if(res.code == 1){\r\n                            this.notify('评分成功','success');\r\n                            this.getRank(this.songListId);\r\n                        }else{\r\n                            this.notify('评分失败','error');\r\n                        }\r\n                    })\r\n                    .catch(err =>{\r\n                        this.notify('您已经评价过啦','error');\r\n                    })\r\n            }else{\r\n                this.rank = null;\r\n                 this.notify('请先登录','warning');\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../assets/css/song-list-album.scss';\r\n</style>\r\n"]}]}