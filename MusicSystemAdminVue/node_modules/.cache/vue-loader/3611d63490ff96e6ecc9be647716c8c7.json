{"remainingRequest":"/Users/jiawang/售卖项目/影院管理系统/MusicSystem/MusicSystemAdminVue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jiawang/售卖项目/影院管理系统/MusicSystem/MusicSystemAdminVue/src/pages/ListSongPage.vue?vue&type=style&index=0&id=09abb1a6&scoped=true&lang=css&","dependencies":[{"path":"/Users/jiawang/售卖项目/影院管理系统/MusicSystem/MusicSystemAdminVue/src/pages/ListSongPage.vue","mtime":1696062554000},{"path":"/Users/jiawang/售卖项目/影院管理系统/MusicSystem/MusicSystemAdminVue/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":1696221622943},{"path":"/Users/jiawang/售卖项目/影院管理系统/MusicSystem/MusicSystemAdminVue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1696221623344},{"path":"/Users/jiawang/售卖项目/影院管理系统/MusicSystem/MusicSystemAdminVue/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":1696221623063},{"path":"/Users/jiawang/售卖项目/影院管理系统/MusicSystem/MusicSystemAdminVue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1696221622669},{"path":"/Users/jiawang/售卖项目/影院管理系统/MusicSystem/MusicSystemAdminVue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1696221623165}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouaGFuZGxlLWJveCB7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCn0NCi5zb25nLWltZyB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgaGVpZ2h0OiA4MHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCi5oYW5kbGUtaW5wdXQgew0KICAgIHdpZHRoOiAzMDBweDsNCiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQp9DQoucGFnaW5hdGlvbiB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCn0NCi5wbGF5IHsNCiAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgei1pbmRleDogMTAwOw0KICAgIHdpZHRoOiA4MHB4Ow0KICAgIGhlaWdodDogODBweDsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHRvcDogMThweDsNCiAgICBsZWZ0OiAxNXB4Ow0KfQ0KDQouaWNvbiB7DQogICAgd2lkdGg6IDJlbTsNCiAgICBoZWlnaHQ6IDJlbTsNCiAgICBjb2xvcjogd2hpdGU7DQogICAgZmlsbDogY3VycmVudENvbG9yOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQp9DQo="},{"version":3,"sources":["ListSongPage.vue"],"names":[],"mappings":";AAkPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ListSongPage.vue","sourceRoot":"src/pages","sourcesContent":["<template>\r\n    <div class=\"table\">\r\n        <div class=\"crumbs\" style=\"padding: 20px 0 5px 20px\">\r\n            <i class=\"iconfont icon-r-list\" style=\"font-size: 24px\">\r\n                歌单歌曲管理</i\r\n            >\r\n        </div>\r\n        <div class=\"container\">\r\n            <div class=\"handle-box\">\r\n                <el-input\r\n                    v-model=\"select_word\"\r\n                    placeholder=\"请输入歌曲名\"\r\n                    class=\"handle-input\"\r\n                ></el-input>\r\n                <br /><br />\r\n                <el-button type=\"danger\" style=\"font-size: 18px\" @click=\"delAll\"\r\n                    ><i\r\n                        class=\"iconfont icon-r-delete\"\r\n                        style=\"font-size: 22px\"\r\n                    ></i>\r\n                    批量删除</el-button\r\n                >\r\n                <el-button\r\n                    type=\"success\"\r\n                    style=\"font-size: 18px\"\r\n                    @click=\"centerDialogVisible = true\"\r\n                    ><i class=\"iconfont icon-r-add\" style=\"font-size: 22px\"></i>\r\n                    添加歌曲</el-button\r\n                >\r\n            </div>\r\n        </div>\r\n        <el-table\r\n            ref=\"multipleTable\"\r\n            border\r\n            style=\"width: 100%\"\r\n            height=\"680px\"\r\n            :data=\"tableData\"\r\n            @selection-change=\"handleSelectionChange\"\r\n        >\r\n            <el-table-column type=\"selection\" width=\"40\"></el-table-column>\r\n            <el-table-column\r\n                prop=\"name\"\r\n                label=\"歌手-歌名\"\r\n                align=\"center\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n                label=\"操作\"\r\n                width=\"150\"\r\n                align=\"center\"\r\n                fixed=\"right\"\r\n            >\r\n                <template slot-scope=\"scope\">\r\n                    <el-button\r\n                        style=\"font-size: 18px\"\r\n                        type=\"danger\"\r\n                        @click=\"handleDelete(scope.row.id)\"\r\n                        ><i\r\n                            class=\"iconfont icon-r-delete\"\r\n                            style=\"font-size: 22px\"\r\n                        ></i>\r\n                        删除</el-button\r\n                    >\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n        <el-dialog\r\n            title=\"添加歌曲\"\r\n            :visible.sync=\"centerDialogVisible\"\r\n            width=\"400px\"\r\n            center\r\n        >\r\n            <el-form\r\n                :model=\"registerForm\"\r\n                ref=\"registerForm\"\r\n                label-width=\"80px\"\r\n                action=\"\"\r\n                id=\"tf\"\r\n            >\r\n                <el-form-item prop=\"singerName\" label=\"歌手名字\" size=\"mini\">\r\n                    <el-input\r\n                        v-model=\"registerForm.singerName\"\r\n                        placeholder=\"歌手名字\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item prop=\"songName\" label=\"歌曲名字\" size=\"mini\">\r\n                    <el-input\r\n                        v-model=\"registerForm.songName\"\r\n                        placeholder=\"歌曲名字\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n            <span slot=\"footer\">\r\n                <el-button size=\"mini\" @click=\"centerDialogVisible = false\"\r\n                    >取消</el-button\r\n                >\r\n                <el-button size=\"mini\" @click=\"getSongId\">确定</el-button>\r\n            </span>\r\n        </el-dialog>\r\n        <el-dialog\r\n            title=\"删除歌曲\"\r\n            :visible.sync=\"delVisible\"\r\n            width=\"300px\"\r\n            center\r\n        >\r\n            <div align=\"center\">删除不可恢复，是否确定删除？</div>\r\n            <span slot=\"footer\">\r\n                <el-button size=\"mini\" @click=\"delVisible = false\"\r\n                    >取消</el-button\r\n                >\r\n                <el-button size=\"mini\" @click=\"deleteRow\">确定</el-button>\r\n            </span>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mixin } from \"../mixins/index\";\r\nimport {\r\n    listSongDetail,\r\n    songOfSongId,\r\n    songOfSongName,\r\n    listSongAdd,\r\n    delListSong,\r\n} from \"../api/index\";\r\n\r\nexport default {\r\n    mixins: [mixin],\r\n    data() {\r\n        return {\r\n            centerDialogVisible: false, //添加弹窗是否显示\r\n            delVisible: false, //删除弹窗是否显示\r\n            registerForm: {\r\n                //添加框\r\n                singerName: \"\", //歌手名字\r\n                songName: \"\", //歌曲名字\r\n            },\r\n            tableData: [],\r\n            tempData: [],\r\n            select_word: \"\",\r\n            idx: -1, //当前选择项\r\n            multipleSelection: [], //哪些项已经打勾\r\n            songListId: \"\", //歌单id\r\n        };\r\n    },\r\n    watch: {\r\n        //搜索框里面的内容发生变化的时候，搜索结果table列表的内容跟着它的内容发生变化\r\n        select_word: function () {\r\n            if (this.select_word == \"\") {\r\n                this.tableData = this.tempData;\r\n            } else {\r\n                this.tableData = [];\r\n                for (let item of this.tempData) {\r\n                    if (item.name.includes(this.select_word)) {\r\n                        this.tableData.push(item);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n    },\r\n    created() {\r\n        this.songListId = this.$route.query.id;\r\n        this.getData();\r\n    },\r\n    methods: {\r\n        //查询所有歌手\r\n        getData() {\r\n            this.tempData = [];\r\n            this.tableData = [];\r\n            listSongDetail(this.songListId).then((res) => {\r\n                for (let item of res) {\r\n                    this.getSong(item.songId);\r\n                }\r\n            });\r\n        },\r\n        //根据歌曲id查询歌曲对象，放到tempData和tableData里面\r\n        getSong(id) {\r\n            songOfSongId(id)\r\n                .then((res) => {\r\n                    this.tempData.push(res);\r\n                    this.tableData.push(res);\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err);\r\n                });\r\n        },\r\n        //添加歌曲前的准备，获取到歌曲id\r\n        getSongId() {\r\n            let _this = this;\r\n            var songOfName =\r\n                _this.registerForm.singerName +\r\n                \"-\" +\r\n                _this.registerForm.songName;\r\n            songOfSongName(songOfName).then((res) => {\r\n                if (res[0] == undefined) {\r\n                    this.notify(\"歌曲或者歌名不正确\", \"warning\");\r\n                    return;\r\n                }\r\n                _this.addSong(res[0].id);\r\n            });\r\n        },\r\n        //添加歌曲\r\n        addSong(songId) {\r\n            let _this = this;\r\n            let params = new URLSearchParams();\r\n            params.append(\"songId\", songId);\r\n            params.append(\"songListId\", this.songListId);\r\n\r\n            listSongAdd(params)\r\n                .then((res) => {\r\n                    if (res.code == 1) {\r\n                        this.getData();\r\n                        this.notify(\"添加成功\", \"success\");\r\n                    } else {\r\n                        this.notify(\"添加失败\", \"error\");\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err);\r\n                });\r\n            _this.centerDialogVisible = false;\r\n        },\r\n        //删除一条歌曲\r\n        deleteRow() {\r\n            delListSong(this.idx, this.songListId)\r\n                .then((res) => {\r\n                    if (res) {\r\n                        this.getData();\r\n                        this.notify(\"删除成功\", \"success\");\r\n                    } else {\r\n                        this.notify(\"删除失败\", \"error\");\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    console.log(err);\r\n                });\r\n            this.delVisible = false;\r\n        },\r\n    },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.handle-box {\r\n    margin-bottom: 20px;\r\n}\r\n.song-img {\r\n    width: 100%;\r\n    height: 80px;\r\n    border-radius: 5px;\r\n    margin-bottom: 5px;\r\n    overflow: hidden;\r\n}\r\n.handle-input {\r\n    width: 300px;\r\n    display: inline-block;\r\n}\r\n.pagination {\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n.play {\r\n    position: absolute;\r\n    z-index: 100;\r\n    width: 80px;\r\n    height: 80px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    top: 18px;\r\n    left: 15px;\r\n}\r\n\r\n.icon {\r\n    width: 2em;\r\n    height: 2em;\r\n    color: white;\r\n    fill: currentColor;\r\n    overflow: hidden;\r\n}\r\n</style>"]}]}